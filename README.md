# Telegram WebApp (Vite)

Три экрана:
1) «Перемешать» — кнопка и короткая анимация; затем вызывает `POST /api/deck/start`.
2) «Тянуть карту» — по кнопке вызывает `/draw`; добавляет закрытую карту в ленту до нужного количества.
3) «Перевернуть» — тап по карте вызывает `/flip` и показывает `{name,suit,reversed}`. Кнопка «Готово» — `/finish` и закрывает WebApp.

Особенности:
- Локально хранит `session_id`, `deck_token`, прогресс в `localStorage` — переживает перезагрузку и оффлайн. Повторные запросы сделаны идемпотентно на уровне клиента.
- Индикатор прогресса «карта X из Y»; значок перевёрнутости — поворот 180° (иконка «⟲»).
- Адаптив до 320px, тёмная тема, кликабельные элементы ≥44px.

## Запуск (локально)
1) Node.js LTS (18+)
2) Установка:
```bash
npm install
```
3) Дев-сервер:
```bash
npm run dev
```
4) Открыть URL Vite (обычно `http://localhost:5173/`).

## Сборка
```bash
npm run build
```

## Интеграция с Telegram
- Используйте `window.Telegram.WebApp` для расширений (цвета, закрытие окна и пр.).
- По кнопке «Готово» WebApp закрывается, если доступно API Telegram.

## Деплой на GitHub Pages
1) Добавьте `webapp/vite.config.ts` с `base: './'` (уже есть), чтобы сборка работала из подкаталога.
2) Соберите проект:
```bash
npm run build
```
3) Залейте содержимое `webapp/dist/` в ветку Pages (например, `gh-pages`) и включите Pages в настройках репозитория.
4) Итоговый URL будет вида `https://<user>.github.io/<repo>/`. Используйте его как `WEBAPP_URL`.

Если видите чёрный экран:
- Проверьте, что `base: './'` в `vite.config.ts`.
- Убедитесь, что загружается `index.html`, `assets/*` без 404 (откройте DevTools → Network).
- Очистите кэш, проверьте консоль на ошибки JS.
